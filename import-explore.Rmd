---
title: "Road surface: import and explore"
author: "Mark Ruddy"
date: "2017-02-27"
output: html_notebook
---

Data on road lengths in Great Britain can be found from the [Office for National Statistics (ONS)](https://www.gov.uk/government/statistical-data-sets/rdl02-road-lengths-kms). This is provided as road type by GB Local Authority from 2005 to 2015. A supplement also lists road lengths, with various data gaps, dating back to 1914.

The Ordnance Survey also holds information on road length in their [OS Open Roads](https://www.ordnancesurvey.co.uk/business-and-government/products/os-open-roads.html) product - available under the Open Government Licence ([OGL](http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/)). This could potentially allow any analysis to be broken down into smaller geographic areas than that achievable from the ONS data. But OS Open Roads only incldues Motorways, A-roads, B-roads.

Both datasets require assumptions on the width's of different road types. The ONS estimate includes OS data and additionally draws on information from Local Authorities, the Scottish and Welsh governments, and the Highways Agency. With the additional information present in the ONS data I decided to go with that as a basis for estimating road area.

## ONS road length

[Office for National Statistics (ONS)](https://www.gov.uk/government/statistical-data-sets/rdl02-road-lengths-kms) are downloadable as .ods files. 

Focussing on the Local Authority dataset:

```{r load-packages, include=FALSE}
library(tidyverse)
library(readODS)
library(httr)
```

I'm interested in looking at road lengths across all years (2005-2015) and 


```{r read-data}

url <- "https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/523715/rdl0202.ods"

GET(url, write_disk("../data/ONS-GB-roads.ods", overwrite = T))

ons.roads <- read_ods("../data/ONS-GB-roads.ods", sheet = 1, skip = 6)
```

Inspection of ONS-GB-roads.ods shows that:

* There are 6 lines to skip before the dataset begins.
* The cell range of the dataset is:
  * A7:Z211 for 2005 to 2008; 
  * A7:Z213 from 2009 to 2012 
    - Rural 'C' and 'U', and Urban 'C' and 'U' are separate up to 2013.
    - Cheshire UA is split into Cheshire East UA, and Cheshire West and Chester UA from 2009.
    - Bedfordshire is split into Bedford UA and Central Bedfordshire UA from 2009.
  * and A7:X213 from 2013 to 2015 - Rural 'C' and 'U', and Urban 'C' and 'U' are combined from 2013.
* Two extra Local Authorities were added from 2008 to 2009 ? 



```{r}
path <- "../data/ONS-GB-roads.ods"
## range for most sheets
range <- "A6:X212"

#sheets we're interested in
sheets <- c(seq(1,19,2),20)

ons.call <- function(sheet) {# sheet=vector of sheet numbers
  read_ods(path, sheet = sheet, col_names = TRUE, range = range) #skip=6
}

df.names <- lapply(c(1), ons.call)

df.names

rm(df)

# df = do.call("rbind.data.frame", df) ## combine dfs from list
```












